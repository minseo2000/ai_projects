# GAN 시작하기

## 이미테이션 게임(튜링 테스트)
- 어떤 알려지지 않은 관찰자가 두 상대방과 벽을 두고 이야기할 때 만약 누가 인간인지 구분할 수 없다면 컴퓨터는 지능을 갖는다고 판단해라.

## 이언 굿펠로 (GAN 발명가)
- 두 개의 구분된 신경망을 사용해 실제와 유사한 데이터를 생성한다.
    - GAN 이용 사례
      1. 진짜 같은 품질의 가짜 이미지를 생성
      2. 낙서를 사진 같은 이미지로 만들기
      3. 말 영상을 달리는 얼룩말로 만들기
    - 모두 레이블된 훈련 데이터를 대량으로 준비하지 않아도 가능

## GAN이란? 
- 생성적 적대 신경망(Generative Adversarial Network)은 동시에 두 개의 모델을 훈련하는 머신러닝의 한 종류이다.
    - 하나(생성자-Generator)는 가짜 데이터를 생성하도록 훈련
    - 다른 하나(판별자-Discriminator)는 가짜 샘플을 구분하도록 훈련

    ### 생성적(genrative)
        - 새로운 데이터를 생성하는 모델을 의미한다.
        - 훈련 데이터셋에 있는 실제 데이터와 구분이 안될 정도로 유사한 샘플을 만들기!
    ### 적대적(Adversarial)
        - GAN의 뼈대를 이루는 두 모델인 생성자와 판별자 사이의 게임 같은 경쟁 구도를 나타냅니다.
        - 생성자가 만든 가짜 데이터를 훈련 데이터셋에 있는 실제 데이터와 구별하는 것
    ### 신경망(network)
        - 생성자와 판별자를 만드는 데 가장 널리 사용하는 머신러닝 모델의 한 종류이다.


## GAN의 동작 방식
- 생성자에게 주어지는 입력 값은 랜덤한 숫자로 구성된 벡터에 불과하다! 
- 생성자는 판별자의 분류 결과에서 피드백을 받아 학습합니다.
- 판별자가 속으면 -> 생성자는 개이득!
- 판별자가 안속으면 -> 생성자는 개손해!

- 생성자와 판별자 네트워크

|    | 생성자                                  | 판별자                                 |
|----|--------------------------------------|-------------------------------------|
| 입력 | 랜덤한 숫자로 구성된 벡터                       | - 훈련 데이터셋에 있는 샘플<br/>생성자가 만든 가짜 샘플  |
| 출력 | 최대한 진짜 같아 보이는 가짜 샘플                  | 입력 샘플이 진짜일 예측 확률                    |
| 목표 | 훈련 데이터셋에 있는 샘플과 구별이 불가능한 가짜 샘플을 생성하기 | 생성자가 만든 가짜 샘플과 훈련 데이터셋의 진짜 샘플과 구별하기 |

### GAN 시스템
- 만약에 실제 손글씨 숫자 이미지를 생성하는 GAN을 목표? 
    ### GAN 훈련하기
```
- GAN의 훈련 알고리즘?

1. 판별자 훈련 모델 만들기
    - 훈련 데이터셋에서 랜덤하게 진짜 샘플 x를 선택합니다.
    - 새로운 랜덤한 잡음 벡터 z를 얻어서 생성자 네트워크를 이용해 가짜 샘플 x*을 합성합니다.
    - 판별자 네트워크를 이용해 x와 x*를 분류합니다.
    - 분류 오차를 계산하고 전체 오차를 역전파해서 판별자의 훈련 가능한 파라미터를 업데이트하고 분류 오차를 최소화합니다.

2. 생성자 훈련하기
    - 생성자 네트워크를 사용해 새로운 랜덤한 잡음 벡터 z에서 가짜 샘플 x*을 합성합니다.
    - 판별자 네트워크를 이용해 x*를 분류합니다.
    - 분류 오차를 계산하고 역전파해서 생성자의 훈련 가능한 파라미터를 업데이트 하고 판별자의 오차를 최대화합니다.
```

    ### GAN 훈련 반복 언제까지!
        - 다음 조건이 충족될 때 내시 균형(참가자 모두 이득을 볼 수 없는 시점!)에 도닥합니다!
            1. 생성자가 훈련 데이터셋의 실제 데이터와 구별이 안되는 데이터를 생성합니다.
            2. 판별자가 할 수 있는 최선이 특정 샘플이 진짜인지 가짜인지 랜덤하게 추축하는 것뿐입니다. ( 즉, 샘플이 진짜인지 아닌지 50대50의 확률로 추측합니다)

## 생성 모델링 시작하기

### 오토인코더의 동작 방식
오토인코더는 데이터를 자동으로 인코딩할 수 있게 도와줍니다. -> 오토인코더는 인코더와, 디코더 두 부분으로 이루어져 있습니다.
- GAN과의 차이점은 오토인코더는 손실함수를 하나만 사용하지만, GAN은 생성자, 판별자 해서 총 2개의 손실함수를 사용합니다.

### 오토인코더 구성

1. x: 크키가 y인 벡터 이미지
2. 인코더 혹은 압축 네트워크(1단계)
3. z : 크기가 z인 잠재공간(2단계)
4. 결과물 혹은 압축 해제 재구성(3단계)
5. x* : 크기가 y인 벡터 결과물

- 마지막으로 x*와 x의 손실함수를 구한다.

### 오토 인코더 활용
1. 이상치 탐지 알고리즘 (z잠재공간에서의 유사도)
2. 데이터 노이지 제거 및 흑백 이미지 해색하기
3. 새로운 이미지를 생성

### 변이형 오토인코더(Veriantional autoencoder)
- 변이형 오토인코더는 잠재 공간을 단순한 수의 집합이 아닌 학습된 평균과 표준편차를 지닌 분포로 표현합니다.


## 첫 번째 GAN 구현하기

### GAN 기초 : 적대적 훈련


## DCGAN 
- 합성곱 신경망을 이용해서 생성자와 판별자를 만든 GAN
